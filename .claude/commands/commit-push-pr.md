# Git 커밋 · 푸시 · PR 생성

변경사항을 확인하고 커밋 후 푸시, PR 생성까지 한 번에 진행합니다.

## 실행 절차

### Step 1: 변경사항 확인
1. `git status`로 변경 파일 확인
2. `git diff --stat`로 변경 요약 확인
3. 변경사항이 없으면 종료

### Step 2: 커밋 방식 선택
아래 2가지 중 하나를 사용자에게 묻고 진행합니다.

1. **작은 단위 분할 커밋**
   - 작업 브랜치의 변경사항을 분석해 논리적으로 나눠 커밋
2. **스테이징 기반 커밋**
   - `git diff --staged`만 분석하고 사용자와 상호작용해 커밋

**방식 1: 작은 단위 분할 커밋 절차**
1. `git status`와 `git diff --stat`를 기준으로 변경을 논리적 단위로 묶기
2. 묶음마다 스테이징:
   - 파일 단위: `git add <file>`
   - 부분 단위: `git add -p`
3. 각 묶음에 대해 커밋 메시지 제안 → 사용자 확인 → 커밋 반복
4. 모든 묶음 커밋 후 다음 단계로 이동

**방식 2: 스테이징 기반 커밋 절차**
1. `git diff --staged`만 분석
2. 스테이징된 변경 기준으로 커밋 메시지 제안
3. 사용자 확인 → 커밋
4. 스테이징된 변경이 더 없으면 다음 단계로 이동

### Step 3: 브랜치 확인
1. `git branch --show-current`로 현재 브랜치 확인
2. 기본 브랜치에서 작업 중이면 새 브랜치 생성
3. 브랜치명 규칙 예시: `feat/`, `fix/`, `docs/`, `chore/`

### Step 4: 커밋 메시지 생성
변경 내용을 분석해 커밋 메시지를 생성합니다.

**커밋 메시지 형식**
```
[이모지] [제목]

## 변경 내용
- [변경1]
- [변경2]
```

**주의사항**
- 커밋 메시지에 `Co-Authored-By` 라인을 절대 추가하지 않는다

**이모지 가이드**
| 이모지 | 용도 |
|--------|------|
| 🚀 | 새 기능, 대규모 업데이트 |
| ✨ | 기능 추가 |
| 🔧 | 설정/구성 변경 |
| 📝 | 문서 수정 |
| 🐛 | 버그 수정 |
| 🎨 | 스타일/UI 변경 |
| ♻️ | 리팩토링 |
| 🗑️ | 파일 삭제 |
| 📦 | 패키지/의존성 |

### Step 5: 사용자 확인
```
╔══════════════════════════════════════════════════════════════╗
║  📋 진행 전 확인                                             ║
╠══════════════════════════════════════════════════════════════╣
║                                                              ║
║  📁 변경된 파일: [N]개                                        ║
║     - [파일 목록]                                             ║
║                                                              ║
║  📝 커밋 메시지:                                              ║
║     [이모지] [제목]                                           ║
║                                                              ║
║  👉 "확인" (커밋·푸시·PR) / "수정" / "중단"                    ║
╚══════════════════════════════════════════════════════════════╝
```

### Step 6: 커밋 & 푸시
1. `git add -A`
2. `git commit -m "[메시지]"`
3. `git push -u origin [브랜치명]`

### Step 7: PR 생성

#### PR 제목 결정
1. `$ARGUMENTS`가 있으면: 해당 내용을 PR 제목으로 사용
2. `$ARGUMENTS`가 없으면:
   - `git log origin/main..HEAD --oneline`으로 커밋 내역 확인
   - 작업 내용을 한 줄로 요약하여 "~~했습니다" 형태로 제목 생성

#### PR 본문 작성
베이스 브랜치(main) 대비 현재 브랜치의 변경사항을 분석하여 PR 본문을 작성합니다.

1. `git diff origin/main..HEAD --stat`으로 변경된 파일 목록 확인
2. `git diff origin/main..HEAD`으로 상세 변경 내용 확인
3. 분석한 내용을 바탕으로 다음 항목들을 작성:
   - **배경**: 왜 이 작업이 필요했는지 간단히 설명
   - **작업 내용**: 변경된 파일과 기능을 바탕으로 구체적인 작업 내용 작성
   - **리뷰 노트**: 리뷰어가 특별히 확인해야 할 부분이나 논의가 필요한 사항 작성

#### PR 생성 실행
1. GitHub CLI 사용 시
   - `gh pr create --title "[제목]" --body "[본문]" --base [기본브랜치] --head [브랜치명]`
2. GitHub CLI 미사용 시
   - 원격 저장소에서 "Compare & pull request" 버튼으로 생성

### Step 8: 완료
```
╔══════════════════════════════════════════════════════════════╗
║  ✅ 커밋·푸시·PR 완료!                                       ║
╠══════════════════════════════════════════════════════════════╣
║                                                              ║
║  📝 커밋: [해시] [제목]                                       ║
║  🌐 브랜치: [브랜치명]                                        ║
║  🔗 PR: [URL]                                                 ║
║                                                              ║
╚══════════════════════════════════════════════════════════════╝
```

## 옵션
- `/commit-push-pr` - 기본 실행
- `/commit-push-pr -m "메시지"` - 메시지 직접 지정
- `/commit-push-pr --no-pr` - PR 생성 생략
- `/commit-push-pr --no-push` - 커밋만 수행
